!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.SaiStyleColorPicker=e():t.SaiStyleColorPicker=e()}(window,function(){return function(t){var e={};function r(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(o,i,function(e){return t[e]}.bind(null,i));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";r.r(e);r(1);var o=function(){function t(t,e){void 0===e&&(e={}),this.subscriptions={},this.defaultConfig={size:207,thickness:21,matteBorderWidth:2,realBorderWidth:1,realBorderOffset:1,innerBorderGapRadian:Math.PI/180,startAngle:330,backgroundColor:"#fff",borderColor:"#acacac"},this.wheelPanelOptions={},this.colorControl=new i(196,.55,.95),this.centerPoint={x:0,y:0},this.posControl={innerRadius:0,outerRadius:0,middleRadius:0,squareSize:0},this.eventControl={mousemove:!1},this.wheelPanelOptions=Object.assign({},this.defaultConfig,e),this.el=t,this.init()}return t.prototype.getColor=function(t){var e;switch(t){case"hsl":var r,o=this.colorControl,n=o.hue,s=o.saturation,a=o.value;return n=(e=i.hsv2hsl(n,s,a))[0],s=e[1],r=e[2],"hsl("+Math.round(n)+", "+Math.round(100*s)+"%, "+Math.round(100*r)+"%)";case"rgb":return this.colorControl.toColorString();case"hex":default:var h=this.colorControl,l=h.red,u=h.green,c=h.blue;return l=Math.round(l),u=Math.round(u),c=Math.round(c),i.rgb2hex(l,u,c)}},t.prototype.setColor=function(t){var e,r,o,n,s;if("#"===(t=t.trim()).charAt(0)){var a,h=i.hex2rgb(t),l=h[0],u=h[1],c=h[2];o=(e=i.rgb2hsl(l,u,c))[0],n=e[1],a=e[2],o=(r=i.hsl2hsv(o,n,a))[0],n=r[1],s=r[2]}this.colorControl.hue=o,this.colorControl.saturation=n,this.colorControl.value=s,this.colorControl.refreshByHSV()},t.prototype.on=function(t,e){this.subscriptions[t]=this.subscriptions[t]||[],this.subscriptions[t].push(e)},t.prototype.off=function(t,e){var r=this.subscriptions[t],o=r.indexOf(e);o>-1&&r.splice(o,1)},t.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var o=this.subscriptions[t];if(o)for(var i=0;i<o.length;i++){o[i].apply(null,e)}},t.prototype.init=function(){this.genElements(),this.refreshColorDisplay(),this.bindEvents()},t.prototype.genElements=function(){var t=document.createDocumentFragment(),e=this.createFrameCanvas(),r={width:this.wheelPanelOptions.size+"px",height:this.wheelPanelOptions.size+"px",padding:(this.wheelPanelOptions.size-this.posControl.squareSize)/2+"px",background:this.wheelPanelOptions.backgroundColor+" url("+e.toDataURL()+") center center no-repeat"},o=document.createElement("div");o.className="sai-color-picker";var i=document.createElement("div");i.className="sai-picking-area";var n=document.createElement("div");n.className="sai-hue-picker";var s=document.createElement("div");s.className="sai-picking-area-container",this.setStyleCombined(s,r),i.appendChild(o),s.appendChild(i),s.appendChild(n),t.appendChild(s),this.el.appendChild(t),this.pickingAreaContainer=s,this.pickingArea=i,this.colorPicker=o,this.huePicker=n},t.prototype.setStyleCombined=function(t,e){var r=t.style;Object.keys(e).forEach(function(t){var o=e[t];r[t]=o})},t.prototype.bindEvents=function(){var t=this;this.pickingAreaContainer.addEventListener("mousedown",function(e){var r=e.clientX+window.pageXOffset,o=e.clientY+window.pageYOffset;t.triggerDown(r,o),e.preventDefault()})},t.prototype.triggerDown=function(t,e){var r=this.pickingAreaContainer.getBoundingClientRect();this.centerPoint.x=(r.left+r.right)/2+window.pageXOffset,this.centerPoint.y=(r.top+r.bottom)/2+window.pageYOffset;var o=t-this.centerPoint.x,i=e-this.centerPoint.y,n=Math.sqrt(o*o+i*i),s=t-(this.centerPoint.x-this.posControl.squareSize/2),a=e-(this.centerPoint.y-this.posControl.squareSize/2);n<=this.posControl.outerRadius&&n>=this.posControl.innerRadius?(this.triggerMoveForHue(t,e),this.startWatchMove("hue")):s>=0&&s<=this.posControl.squareSize&&a>=0&&a<=this.posControl.squareSize&&(this.triggerMoveForColor(t,e),this.startWatchMove("color"))},t.prototype.startWatchMove=function(t){var e=function(t){return function(e){var r=e.clientX+window.pageXOffset,o=e.clientY+window.pageYOffset;t(r,o)}},r=this.eventControl,o=e("hue"===t?this.triggerMoveForHue.bind(this):this.triggerMoveForColor.bind(this));r.mousemove||(r.mousemove=!0,document.addEventListener("mousemove",o),document.addEventListener("mouseup",function t(){document.removeEventListener("mouseup",t),document.removeEventListener("mousemove",o),r.mousemove=!1}))},t.prototype.validateWithEdge=function(t,e,r){return t>r?r:t<0?e:t},t.prototype.triggerMoveForColor=function(t,e){var r=this.centerPoint.x-this.posControl.squareSize/2,o=this.centerPoint.y-this.posControl.squareSize/2,n=this.validateWithEdge(t-r,0,this.posControl.squareSize),s=this.validateWithEdge(e-o,0,this.posControl.squareSize),a=n/this.posControl.squareSize,h=s/this.posControl.squareSize,l=this.colorControl.hue,u=new i(l,a,1-h);this.colorControl=u,this.refreshColorDisplay()},t.prototype.triggerMoveForHue=function(t,e){var r=t-this.centerPoint.x,o=e-this.centerPoint.y,i=(s(Math.atan2(o,r))+this.wheelPanelOptions.startAngle)%360;this.colorControl.hue=i,this.colorControl.refreshByHSV(),this.refreshColorDisplay()},t.prototype.refreshColorDisplay=function(){var t=new i(this.colorControl.hue,1,1),e=(this.colorControl.hue+180)%360,r=(this.colorControl.hue+180-this.wheelPanelOptions.startAngle)%360/180*Math.PI,o=this.posControl.middleRadius*Math.cos(r)+this.wheelPanelOptions.size/2,n=this.posControl.middleRadius*Math.sin(r)+this.wheelPanelOptions.size/2,s=new i(e,1,1),a=this.colorControl.saturation*this.posControl.squareSize,h=(1-this.colorControl.value)*this.posControl.squareSize,l=this.colorControl.value,u=1-this.colorControl.value*(1-this.colorControl.saturation),c=new i(e,l,u);this.pickingArea.style.backgroundColor=t.toColorString(),this.huePicker.style.borderColor=s.toColorString(),this.huePicker.style.left=o+"px",this.huePicker.style.top=n+"px",this.colorPicker.style.borderColor=c.toColorString(),this.colorPicker.style.left=a+"px",this.colorPicker.style.top=h+"px",this.emit("update",this.getColor())},t.prototype.createFrameCanvas=function(){var t=document.createElement("canvas"),e=t.getContext("2d");return t.width=this.wheelPanelOptions.size,t.height=this.wheelPanelOptions.size,this.drawHueWheel(e),t},t.prototype.drawHueWheel=function(t){var e=this.wheelPanelOptions,r=t.createImageData(e.size,e.size),o=r.data,a=e.size/2-e.realBorderOffset-e.realBorderWidth,h=a-e.thickness,l=a,u=e.size/2,c=e.size/2,d=e.size;this.posControl.innerRadius=h,this.posControl.outerRadius=l,this.posControl.middleRadius=(h+l)/2,this.posControl.squareSize=2*((h-e.realBorderOffset)/Math.sqrt(2)-e.realBorderOffset);for(var p=-a;p<a;p++)for(var f=-a;f<a;f++){var v=n(p,f),g=v[0],C=v[1];if(g<=l&&g>=h){var m=s(C),y=4*(p+e.size/2+(f+e.size/2)*d),b=(m+e.startAngle)%360,P=i.hsv2rgb(b,1,1),M=P[0],w=P[1],S=P[2];o[y]=M,o[y+1]=w,o[y+2]=S,o[y+3]=255}}t.putImageData(r,0,0),t.lineWidth=e.matteBorderWidth,t.strokeStyle=e.backgroundColor,t.beginPath(),t.arc(u,c,l,0,2*Math.PI),t.stroke(),t.beginPath(),t.arc(u,c,h,0,2*Math.PI),t.stroke(),t.lineWidth=e.realBorderWidth,t.strokeStyle=e.borderColor,t.beginPath(),t.arc(u,c,l+e.realBorderOffset,0,2*Math.PI),t.stroke();for(var O=[[-Math.PI/4+e.innerBorderGapRadian,Math.PI/4-e.innerBorderGapRadian],[Math.PI/4+e.innerBorderGapRadian,3*Math.PI/4-e.innerBorderGapRadian],[3*Math.PI/4+e.innerBorderGapRadian,5*Math.PI/4-e.innerBorderGapRadian],[5*Math.PI/4+e.innerBorderGapRadian,7*Math.PI/4-e.innerBorderGapRadian]],k=0;k<O.length;k++)t.beginPath(),t.arc(u,c,h-e.realBorderOffset,O[k][0],O[k][1]),t.closePath(),t.stroke()},t}(),i=function(){function t(t,e,r){this.hue=t,this.saturation=e,this.value=r,this.refreshByHSV()}return t.prototype.toColorString=function(){return"rgb("+Math.round(this.red)+", "+Math.round(this.green)+", "+Math.round(this.blue)+")"},t.prototype.refreshByHSV=function(){var e=t.hsv2rgb(this.hue,this.saturation,this.value),r=e[0],o=e[1],i=e[2];this.red=r,this.green=o,this.blue=i},t.hsv2rgb=function(t,e,r){var o,i,n,s,a,h,l,u,c,d=r*e,p=t/60,f=d*(1-Math.abs(p%2-1));p>=0&&p<=1?(l=(o=[d,f,0])[0],u=o[1],c=o[2]):p>=1&&p<=2?(l=(i=[f,d,0])[0],u=i[1],c=i[2]):p>=2&&p<=3?(l=(n=[0,d,f])[0],u=n[1],c=n[2]):p>=3&&p<=4?(l=(s=[0,f,d])[0],u=s[1],c=s[2]):p>=4&&p<=5?(l=(a=[f,0,d])[0],u=a[1],c=a[2]):p>=5&&p<=6&&(l=(h=[d,0,f])[0],u=h[1],c=h[2]);var v=r-d,g=[l+v,u+v,c+v];return[255*g[0],255*g[1],255*g[2]]},t.rgb2hsl=function(t,e,r){var o=Math.max(t,e,r),i=Math.min(t,e,r),n=o-i,s=(o+i)/2,a=1-Math.abs(o+i-1),h=0;return n&&(o==t&&(h=60*(0+(e-r)/n)),o==e&&(h=60*(2+(r-t)/n)),o==r&&(h=60*(4+(t-e)/n))),[(h<0?h+360:h)%360,a?n/a:0,s]},t.hsl2hsv=function(t,e,r){var o=e*Math.min(r,1-r)+r;return[t,o?2-2*r/o:0,o]},t.hsv2hsl=function(t,e,r){var o=r-r*e/2,i=Math.min(o,1-o);return[t,i?(r-o)/i:0,o]},t.hex2rgb=function(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,r,o){return e+e+r+r+o+o});var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t),r=[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)];return[r[0],r[1],r[2]]},t.rgb2hex=function(t,e,r){return"#"+[t,e,r].map(function(t){return t.toString(16).padStart(2,"0")}).join("")},t}();function n(t,e){return[Math.sqrt(t*t+e*e),Math.atan2(e,t)]}function s(t){return(t+Math.PI)/(2*Math.PI)*360}e.default=o},function(t,e,r){}]).default});
//# sourceMappingURL=sai-style-color-picker.js.map